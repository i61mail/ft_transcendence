{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/ChatsWrapper.tsx"],"sourcesContent":["\"use client\"\nimport React, { useRef, useEffect } from 'react'\nimport AllChats from './AllChats'\nimport MainChat from './MainChat'\nimport { MessageProps } from '@/types/common.types'\nimport { useAuth } from '../../../context/AuthProvider'\nimport { useChatContext } from '@/context/ChatContextProvider'\nimport { useRouter } from 'next/router';\n\n\nconst ChatsWrapper = ({chat_id}: {chat_id: number}) => {\n  const chatContext = useChatContext();\n  const socket = useRef<WebSocket | null>(null);\n  const currentChatId = useRef<number>(chat_id);\n           \n  useEffect(() =>\n  {\n    console.log(\"now in\", chat_id);\n    currentChatId.current = chat_id;\n    chatContext.friends.forEach(element => {\n    if (element.id == currentChatId.current)\n          {\n            chatContext.changePointedUser(element);\n            return ;\n          }\n      });\n  }, [chat_id])\n\n\n  // useEffect(()=>\n  // {\n  //   if (!socket.current)\n  //   {\n  //     console.log(\"creating new socket for\", currentChatId.current);\n  //     socket.current = new WebSocket(\"ws://localhost:4000/sockets/messages\");\n  //     socket.current.onopen = () =>\n  //     {\n  //       let data = {\n  //         type: \"auth\",\n  //         content: currentChatId.current \n  //       }\n  //       if (socket.current?.readyState === WebSocket.OPEN)\n  //         socket.current.send(JSON.stringify(data));\n  //     }\n  //     socket.current.onmessage = (msg)=>\n  //     {\n  //       console.log(\"received message on\", currentChatId.current, socket.current?.binaryType)\n  //       const {receiver, sender, content, id, friendship_id} = JSON.parse(msg.data);\n  //       if (currentChatId.current == friendship_id)\n  //       {\n  //         const newMessage: MessageProps = {sender: sender, receiver: receiver, content: content, id: id};\n  //         console.log(\"currently in chat\", currentChatId.current);\n  //         console.log(\"adding message to chat\", currentChatId.current, chat_id);\n  //         chatContext.updateMessages((previous) => [newMessage, ...previous]);\n  //       }\n  //     }\n  //     socket.current.onerror = (error) => {\n  //       console.error('WebSocket error:', error);\n  //     };\n  //   }\n  // },[chat_id])\n\n  return (   \n    <>\n          {/* <MainChat ref={socket}/> */}\n    </>\n  )\n}\n\nexport default ChatsWrapper\n"],"names":[],"mappings":";;;;;AACA;AAKA;AANA;;;;AAUA,MAAM,eAAe,CAAC,EAAC,OAAO,EAAoB;IAChD,MAAM,cAAc,IAAA,4LAAc;IAClC,MAAM,SAAS,IAAA,0PAAM,EAAmB;IACxC,MAAM,gBAAgB,IAAA,0PAAM,EAAS;IAErC,IAAA,6PAAS,EAAC;QAER,QAAQ,GAAG,CAAC,UAAU;QACtB,cAAc,OAAO,GAAG;QACxB,YAAY,OAAO,CAAC,OAAO,CAAC,CAAA;YAC5B,IAAI,QAAQ,EAAE,IAAI,cAAc,OAAO,EACjC;gBACE,YAAY,iBAAiB,CAAC;gBAC9B;YACF;QACJ;IACJ,GAAG;QAAC;KAAQ;IAGZ,iBAAiB;IACjB,IAAI;IACJ,yBAAyB;IACzB,MAAM;IACN,qEAAqE;IACrE,8EAA8E;IAC9E,oCAAoC;IACpC,QAAQ;IACR,qBAAqB;IACrB,wBAAwB;IACxB,0CAA0C;IAC1C,UAAU;IACV,2DAA2D;IAC3D,qDAAqD;IACrD,QAAQ;IACR,yCAAyC;IACzC,QAAQ;IACR,8FAA8F;IAC9F,qFAAqF;IACrF,oDAAoD;IACpD,UAAU;IACV,2GAA2G;IAC3G,mEAAmE;IACnE,iFAAiF;IACjF,+EAA+E;IAC/E,UAAU;IACV,QAAQ;IACR,4CAA4C;IAC5C,kDAAkD;IAClD,SAAS;IACT,MAAM;IACN,eAAe;IAEf,qBACE;AAIJ;uCAEe","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/ChatPreview.tsx"],"sourcesContent":["'use client'\nimport React, { useEffect, useRef, useState } from 'react'\nimport Image from 'next/image'\nimport defaultUser from \"../../../public/defaultUser.svg\"\nimport { useChatContext } from '@/context/ChatContextProvider';\nimport { useAuth } from '@/context/AuthProvider';\nimport { FriendshipProps } from '@/types/common.types';\nimport { useRouter } from 'next/navigation';\n\ninterface Props\n{\n    friend: FriendshipProps\n}\n\n\nconst ChatPreview = (data: Props) => {\n    const   chatContext = useChatContext();\n    const   auth = useAuth();\n    const   router = useRouter();\n    const   [latestMessage, setLatestMessage] = useState(\"\");\n    const   [notification, setNotification] = useState(false);\n    const   messageNotification = useRef<WebSocket | null>(null);\n    const   currentPointed = useRef<FriendshipProps>(chatContext.pointedUser);\n\n\n    const getCondition = () => data.friend.username === currentPointed.current?.username;\n\n    useEffect(() =>\n    {\n        currentPointed.current = chatContext.pointedUser;\n    }, [chatContext.pointedUser])\n\n\n    // useEffect(() =>\n    // {\n    //     if (!messageNotification.current)\n    //     {\n    //         messageNotification.current = new WebSocket(\"ws://localhost:4000/sockets/notifications/chatPreview\");\n    //         messageNotification.current.onopen = () =>\n    //         {\n    //             let value =  {\n    //                 type: \"registration\",\n    //                 sender: data.friend.username,\n    //                 receiver: auth.user?.username\n    //             }\n    //             if (messageNotification.current?.readyState === WebSocket.OPEN)\n    //                 messageNotification.current.send(JSON.stringify(value));\n    //         }\n    //         messageNotification.current.onmessage = (msg) =>\n    //         {\n    //             const {type, message} = JSON.parse(msg.data.toString());\n    //             console.log(\"receiving noti\", message);\n    //             setLatestMessage(message);\n    //             if (getCondition() === false)\n    //                 setNotification(true);\n    //         }\n    //         messageNotification.current.onerror = (error) => {\n    //             console.error('WebSocket error:', error);\n    //         };\n    //     }\n    // },[])\n\n   return (\n    <div onClick={() => {\n        setNotification(false);\n        router.push(`/chats/${data.friend.id}`)\n    }} className={`h-20 w-full rounded-xl flex px-3 gap-x-5 items-center ${chatContext.pointedUser?.username === data.friend.username && \"bg-[#B0BBCF]\"} ${notification && \"border-2 bg-blue-100 border-white\"}`}>\n        <div className='size-[60] rounded-full bg-gray-200'>\n            <Image className=\"size-fit\" src={defaultUser} alt='search icon'/>\n        </div>\n        <div className='flex flex-col gap-y-0.5'>\n            <h1 className='text-[24px]'>{data.friend.username}</h1>\n            <p className='px-3'>{latestMessage}</p>\n        </div>\n    </div>\n)\n}\n\nexport default ChatPreview\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;;AAeA,MAAM,cAAc,CAAC;IACjB,MAAQ,cAAc,IAAA,4LAAc;IACpC,MAAQ,OAAO,IAAA,8KAAO;IACtB,MAAQ,SAAS,IAAA,0LAAS;IAC1B,MAAQ,CAAC,eAAe,iBAAiB,GAAG,IAAA,4PAAQ,EAAC;IACrD,MAAQ,CAAC,cAAc,gBAAgB,GAAG,IAAA,4PAAQ,EAAC;IACnD,MAAQ,sBAAsB,IAAA,0PAAM,EAAmB;IACvD,MAAQ,iBAAiB,IAAA,0PAAM,EAAkB,YAAY,WAAW;IAGxE,MAAM,eAAe,IAAM,KAAK,MAAM,CAAC,QAAQ,KAAK,eAAe,OAAO,EAAE;IAE5E,IAAA,6PAAS,EAAC;QAEN,eAAe,OAAO,GAAG,YAAY,WAAW;IACpD,GAAG;QAAC,YAAY,WAAW;KAAC;IAG5B,kBAAkB;IAClB,IAAI;IACJ,wCAAwC;IACxC,QAAQ;IACR,gHAAgH;IAChH,qDAAqD;IACrD,YAAY;IACZ,6BAA6B;IAC7B,wCAAwC;IACxC,gDAAgD;IAChD,gDAAgD;IAChD,gBAAgB;IAChB,8EAA8E;IAC9E,2EAA2E;IAC3E,YAAY;IACZ,2DAA2D;IAC3D,YAAY;IACZ,uEAAuE;IACvE,sDAAsD;IACtD,yCAAyC;IACzC,4CAA4C;IAC5C,yCAAyC;IACzC,YAAY;IACZ,6DAA6D;IAC7D,wDAAwD;IACxD,aAAa;IACb,QAAQ;IACR,QAAQ;IAET,qBACC,yRAAC;QAAI,SAAS;YACV,gBAAgB;YAChB,OAAO,IAAI,CAAC,CAAC,OAAO,EAAE,KAAK,MAAM,CAAC,EAAE,EAAE;QAC1C;QAAG,WAAW,CAAC,sDAAsD,EAAE,YAAY,WAAW,EAAE,aAAa,KAAK,MAAM,CAAC,QAAQ,IAAI,eAAe,CAAC,EAAE,gBAAgB,qCAAqC;;0BACxM,yRAAC;gBAAI,WAAU;0BACX,cAAA,yRAAC,mLAAK;oBAAC,WAAU;oBAAW,KAAK,4XAAW;oBAAE,KAAI;;;;;;;;;;;0BAEtD,yRAAC;gBAAI,WAAU;;kCACX,yRAAC;wBAAG,WAAU;kCAAe,KAAK,MAAM,CAAC,QAAQ;;;;;;kCACjD,yRAAC;wBAAE,WAAU;kCAAQ;;;;;;;;;;;;;;;;;;AAIjC;uCAEe","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/public/search.svg.mjs%20%28structured%20image%20object%20with%20data%20url%29"],"sourcesContent":["import src from \"IMAGE\";\nexport default { src, width: 24, height: 24, blurWidth: 0, blurHeight: 0};\n"],"names":[],"mappings":";;;;AAAA;;uCACe;IAAE,KAAA,+JAAG;IAAE,OAAO;IAAI,QAAQ;IAAI,WAAW;IAAG,YAAY;AAAC","debugId":null}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/SearchBar.tsx"],"sourcesContent":["import React from 'react'\nimport Image from 'next/image'\nimport search from \"../../../public/search.svg\"\nimport { useChatContext } from '@/context/ChatContextProvider';\n\nconst SearchBar = () => {\n  const chatContext = useChatContext();\n  return (\n    <div className='h-10 w-full px-4 bg-[#BEC7DA] rounded-full flex gap-2'>\n    <Image src={search} alt='search icon'/>\n    <input onChange={(event)=>chatContext.changeFilter(event.target.value)} className='outline-none w-full text-[20px]' type='text' placeholder=\"Search\"/>\n</div>\n)\n}\n\nexport default SearchBar\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AAEA,MAAM,YAAY;IAChB,MAAM,cAAc,IAAA,4LAAc;IAClC,qBACE,yRAAC;QAAI,WAAU;;0BACf,yRAAC,mLAAK;gBAAC,KAAK,kXAAM;gBAAE,KAAI;;;;;;0BACxB,yRAAC;gBAAM,UAAU,CAAC,QAAQ,YAAY,YAAY,CAAC,MAAM,MAAM,CAAC,KAAK;gBAAG,WAAU;gBAAkC,MAAK;gBAAO,aAAY;;;;;;;;;;;;AAGhJ;uCAEe","debugId":null}},
    {"offset": {"line": 258, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/context/GLobalContextProvider.tsx"],"sourcesContent":["\"use client\"\n\nimport {useRef, createContext, useEffect, useContext} from 'react'\nimport { useAuth } from './AuthProvider';\n\ninterface GlobalContextProp\n{\n    socket:  WebSocket | null,\n}\n\n\nconst GlobalContex = createContext<GlobalContextProp | undefined>(undefined)\n\n\nexport const GlobalContexProvider = ({ children }: {children: React.ReactNode}) =>\n{\n    const socket = useRef<WebSocket | null>(null);\n    const auth = useAuth();\n\n    useEffect(()=>\n        {\n            if (socket.current)\n                return ;\n            socket.current = new WebSocket(\"ws://localhost:4000/sockets\");\n            \n            socket.current.onopen = () =>\n            {\n                const handshake = {type: \"handshake\", id: auth.user?.id};\n                if (socket.current?.readyState === WebSocket.OPEN)\n                    socket.current.send(JSON.stringify(handshake));\n            }\n\n            socket.current.onmessage = (msg) =>\n            {\n                console.log(\"received new data!!\");\n            }\n\n            return () => {\n                socket.current?.close();\n            }\n        }\n    )\n    return (\n        <GlobalContex.Provider value={{socket: socket.current}}>\n            {children}\n        </GlobalContex.Provider>\n    )\n}\n\n\nexport const useGlobalContext = () =>\n{\n    const context = useContext(GlobalContex);\n    if (!context)\n        throw new Error(\"wrong use of global context!\");\n    return (context);\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAWA,MAAM,6BAAe,IAAA,iQAAa,EAAgC;AAG3D,MAAM,uBAAuB,CAAC,EAAE,QAAQ,EAA+B;IAE1E,MAAM,SAAS,IAAA,0PAAM,EAAmB;IACxC,MAAM,OAAO,IAAA,8KAAO;IAEpB,IAAA,6PAAS,EAAC;QAEF,IAAI,OAAO,OAAO,EACd;QACJ,OAAO,OAAO,GAAG,IAAI,UAAU;QAE/B,OAAO,OAAO,CAAC,MAAM,GAAG;YAEpB,MAAM,YAAY;gBAAC,MAAM;gBAAa,IAAI,KAAK,IAAI,EAAE;YAAE;YACvD,IAAI,OAAO,OAAO,EAAE,eAAe,UAAU,IAAI,EAC7C,OAAO,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;QAC3C;QAEA,OAAO,OAAO,CAAC,SAAS,GAAG,CAAC;YAExB,QAAQ,GAAG,CAAC;QAChB;QAEA,OAAO;YACH,OAAO,OAAO,EAAE;QACpB;IACJ;IAEJ,qBACI,yRAAC,aAAa,QAAQ;QAAC,OAAO;YAAC,QAAQ,OAAO,OAAO;QAAA;kBAChD;;;;;;AAGb;AAGO,MAAM,mBAAmB;IAE5B,MAAM,UAAU,IAAA,8PAAU,EAAC;IAC3B,IAAI,CAAC,SACD,MAAM,IAAI,MAAM;IACpB,OAAQ;AACZ","debugId":null}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/AllChats.tsx"],"sourcesContent":["'use client'\nimport React from 'react'\nimport ChatPreview from './ChatPreview'\nimport SearchBar from './SearchBar';\nimport { useChatContext } from '@/context/ChatContextProvider';\nimport { useAuth } from '@/context/AuthProvider';\nimport { FriendshipProps } from '@/types/common.types';\nimport { useGlobalContext } from '@/context/GLobalContextProvider';\n\nconst AllChats = () => \n{\n    const chatContext = useChatContext();\n    const {friends} = useGlobalContext();\n\n    const filteredData:FriendshipProps[] = chatContext.filter.length > 0 ? chatContext.friends.filter((data) => data.username.toLocaleLowerCase().includes(chatContext.filter.toLocaleLowerCase())) : chatContext.friends;\n    \n    return (\n        <div className='flex-1 h-full rounded-t-[30] bg-linear-to-t to-[#93A1BF] from-[#4D658100] padding px-6 py-8 flex flex-col gap-y-5'>\n            <h1 className='text-[24px]'>ALL CHATS FOR</h1>\n            <SearchBar />\n            <div className='flex flex-col gap-y-5 h-full overflow-y-scroll'>\n                {\n                    filteredData.map((v:FriendshipProps) =>\n                        {\n                            return (<ChatPreview key={v.id} friend={v}/>)\n                        }\n                    )\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default AllChats\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAGA;AAPA;;;;;;AASA,MAAM,WAAW;IAEb,MAAM,cAAc,IAAA,4LAAc;IAClC,MAAM,EAAC,OAAO,EAAC,GAAG,IAAA,gMAAgB;IAElC,MAAM,eAAiC,YAAY,MAAM,CAAC,MAAM,GAAG,IAAI,YAAY,OAAO,CAAC,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,CAAC,iBAAiB,GAAG,QAAQ,CAAC,YAAY,MAAM,CAAC,iBAAiB,OAAO,YAAY,OAAO;IAErN,qBACI,yRAAC;QAAI,WAAU;;0BACX,yRAAC;gBAAG,WAAU;0BAAc;;;;;;0BAC5B,yRAAC,kMAAS;;;;;0BACV,yRAAC;gBAAI,WAAU;0BAEP,aAAa,GAAG,CAAC,CAAC;oBAEV,qBAAQ,yRAAC,oMAAW;wBAAY,QAAQ;uBAAd,EAAE,EAAE;;;;;gBAClC;;;;;;;;;;;;AAMxB;uCAEe","debugId":null}}]
}