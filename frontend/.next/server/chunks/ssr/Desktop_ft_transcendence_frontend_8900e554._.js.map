{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/ChatPreview.tsx"],"sourcesContent":["'use client'\nimport React, { useEffect, useRef, useState } from 'react'\nimport Image from 'next/image'\nimport defaultUser from \"../../../public/defaultUser.svg\"\nimport { useChatContext } from '@/context/ChatContextProvider';\nimport { useAuth } from '@/context/AuthProvider';\nimport { FriendshipProps } from '@/types/common.types';\nimport { useRouter } from 'next/navigation';\n\ninterface Props\n{\n    friend: FriendshipProps\n}\n\n\nconst ChatPreview = (data: Props) => {\n    const   chatContext = useChatContext();\n    const   auth = useAuth();\n    const   router = useRouter();\n    const   [latestMessage, setLatestMessage] = useState(\"\");\n    const   [notification, setNotification] = useState(false);\n    const   messageNotification = useRef<WebSocket | null>(null);\n    const   currentPointed = useRef<FriendshipProps>(chatContext.pointedUser);\n\n\n    const getCondition = () => data.friend.username === currentPointed.current?.username;\n\n    useEffect(() =>\n    {\n        currentPointed.current = chatContext.pointedUser;\n    }, [chatContext.pointedUser])\n\n\n    useEffect(() =>\n    {\n        if (!messageNotification.current)\n        {\n            messageNotification.current = new WebSocket(\"ws://localhost:4000/sockets/notifications/chatPreview\");\n            messageNotification.current.onopen = () =>\n            {\n                let value =  {\n                    type: \"registration\",\n                    sender: data.friend.username,\n                    receiver: auth.user?.username\n                }\n                if (messageNotification.current?.readyState === WebSocket.OPEN)\n                    messageNotification.current.send(JSON.stringify(value));\n            }\n            messageNotification.current.onmessage = (msg) =>\n            {\n                const {type, message} = JSON.parse(msg.data.toString());\n                console.log(\"receiving noti\", message);\n                setLatestMessage(message);\n                if (getCondition() === false)\n                    setNotification(true);\n            }\n            messageNotification.current.onerror = (error) => {\n                console.error('WebSocket error:', error);\n            };\n        }\n    },[])\n\n   return (\n    <div onClick={() => {chatContext.changePointedUser(data.friend);\n        setNotification(false);\n        router.push(`/chats/${data.friend.id}`)\n    }} className={`h-20 w-full rounded-xl flex px-3 gap-x-5 items-center ${chatContext.pointedUser?.username === data.friend.username && \"bg-[#B0BBCF]\"} ${notification && \"border-2 bg-blue-100 border-white\"}`}>\n        <div className='size-[60] rounded-full bg-gray-200'>\n            <Image className=\"size-fit\" src={defaultUser} alt='search icon'/>\n        </div>\n        <div className='flex flex-col gap-y-0.5'>\n            <h1 className='text-[24px]'>{data.friend.username}</h1>\n            <p className='px-3'>{latestMessage}</p>\n        </div>\n    </div>\n)\n}\n\nexport default ChatPreview\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;;AAeA,MAAM,cAAc,CAAC;IACjB,MAAQ,cAAc,IAAA,4LAAc;IACpC,MAAQ,OAAO,IAAA,8KAAO;IACtB,MAAQ,SAAS,IAAA,0LAAS;IAC1B,MAAQ,CAAC,eAAe,iBAAiB,GAAG,IAAA,4PAAQ,EAAC;IACrD,MAAQ,CAAC,cAAc,gBAAgB,GAAG,IAAA,4PAAQ,EAAC;IACnD,MAAQ,sBAAsB,IAAA,0PAAM,EAAmB;IACvD,MAAQ,iBAAiB,IAAA,0PAAM,EAAkB,YAAY,WAAW;IAGxE,MAAM,eAAe,IAAM,KAAK,MAAM,CAAC,QAAQ,KAAK,eAAe,OAAO,EAAE;IAE5E,IAAA,6PAAS,EAAC;QAEN,eAAe,OAAO,GAAG,YAAY,WAAW;IACpD,GAAG;QAAC,YAAY,WAAW;KAAC;IAG5B,IAAA,6PAAS,EAAC;QAEN,IAAI,CAAC,oBAAoB,OAAO,EAChC;YACI,oBAAoB,OAAO,GAAG,IAAI,UAAU;YAC5C,oBAAoB,OAAO,CAAC,MAAM,GAAG;gBAEjC,IAAI,QAAS;oBACT,MAAM;oBACN,QAAQ,KAAK,MAAM,CAAC,QAAQ;oBAC5B,UAAU,KAAK,IAAI,EAAE;gBACzB;gBACA,IAAI,oBAAoB,OAAO,EAAE,eAAe,UAAU,IAAI,EAC1D,oBAAoB,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;YACxD;YACA,oBAAoB,OAAO,CAAC,SAAS,GAAG,CAAC;gBAErC,MAAM,EAAC,IAAI,EAAE,OAAO,EAAC,GAAG,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ;gBACpD,QAAQ,GAAG,CAAC,kBAAkB;gBAC9B,iBAAiB;gBACjB,IAAI,mBAAmB,OACnB,gBAAgB;YACxB;YACA,oBAAoB,OAAO,CAAC,OAAO,GAAG,CAAC;gBACnC,QAAQ,KAAK,CAAC,oBAAoB;YACtC;QACJ;IACJ,GAAE,EAAE;IAEL,qBACC,yRAAC;QAAI,SAAS;YAAO,YAAY,iBAAiB,CAAC,KAAK,MAAM;YAC1D,gBAAgB;YAChB,OAAO,IAAI,CAAC,CAAC,OAAO,EAAE,KAAK,MAAM,CAAC,EAAE,EAAE;QAC1C;QAAG,WAAW,CAAC,sDAAsD,EAAE,YAAY,WAAW,EAAE,aAAa,KAAK,MAAM,CAAC,QAAQ,IAAI,eAAe,CAAC,EAAE,gBAAgB,qCAAqC;;0BACxM,yRAAC;gBAAI,WAAU;0BACX,cAAA,yRAAC,mLAAK;oBAAC,WAAU;oBAAW,KAAK,4XAAW;oBAAE,KAAI;;;;;;;;;;;0BAEtD,yRAAC;gBAAI,WAAU;;kCACX,yRAAC;wBAAG,WAAU;kCAAe,KAAK,MAAM,CAAC,QAAQ;;;;;;kCACjD,yRAAC;wBAAE,WAAU;kCAAQ;;;;;;;;;;;;;;;;;;AAIjC;uCAEe","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}