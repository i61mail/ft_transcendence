{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/ChatPreview.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport Image from 'next/image'\nimport defaultUser from \"../../../public/defaultUser.svg\"\nimport { useChatContext } from '@/context/ChatContextProvider';\nimport { useAuth } from '@/context/AuthProvider';\nimport { FriendshipProps } from '@/types/common.types';\nimport { useRouter } from 'next/navigation';\n\ninterface Props\n{\n    friend: FriendshipProps\n}\n\n\nconst ChatPreview = (data: Props) => {\n    const   chatContext = useChatContext();\n    const   auth = useAuth();\n    const   router = useRouter();\n    const   [latestMessage, setLatestMessage] = useState(\"\");\n    const   [notification, setNotification] = useState(false);\n    const   messageNotification = useRef<WebSocket | null>(null);\n    const   currentPointed = useRef<FriendshipProps>(chatContext.pointedUser);\n\n\n    const getCondition = () => data.friend.username === currentPointed.current?.username;\n\n    useEffect(() =>\n    {\n        currentPointed.current = chatContext.pointedUser;\n    }, [chatContext.pointedUser])\n\n\n    useEffect(() =>\n    {\n        if (!messageNotification.current)\n        {\n            messageNotification.current = new WebSocket(\"ws://localhost:4000/sockets/notifications/chatPreview\");\n            messageNotification.current.onopen = () =>\n            {\n                let value =  {\n                    type: \"registration\",\n                    sender: data.friend.username,\n                    receiver: auth.user?.username\n                }\n                if (messageNotification.current?.readyState === WebSocket.OPEN)\n                    messageNotification.current.send(JSON.stringify(value));\n            }\n            messageNotification.current.onmessage = (msg) =>\n            {\n                const {type, message} = JSON.parse(msg.data.toString());\n                console.log(\"receiving noti\", message);\n                setLatestMessage(message);\n                if (getCondition() === false)\n                    setNotification(true);\n            }\n            messageNotification.current.onerror = (error) => {\n                console.error('WebSocket error:', error);\n            };\n        }\n    },[])\n\n   return (\n    <div onClick={() => {chatContext.changePointedUser(data.friend);\n        setNotification(false);\n        router.push(`/chats/${data.friend.id}`)\n    }} className={`h-20 w-full rounded-xl flex px-3 gap-x-5 items-center ${chatContext.pointedUser?.username === data.friend.username && \"bg-[#B0BBCF]\"} ${notification && \"border-2 bg-blue-100 border-white\"}`}>\n        <div className='size-[60] rounded-full bg-gray-200'>\n            <Image className=\"size-fit\" src={defaultUser} alt='search icon'/>\n        </div>\n        <div className='flex flex-col gap-y-0.5'>\n            <h1 className='text-[24px]'>{data.friend.username}</h1>\n            <p className='px-3'>{latestMessage}</p>\n        </div>\n    </div>\n)\n}\n\nexport default ChatPreview\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;;;;;;;;;AAQA,MAAM,cAAc,CAAC;QAmDsD;;IAlDvE,MAAQ,cAAc,IAAA,+LAAc;IACpC,MAAQ,OAAO,IAAA,iLAAO;IACtB,MAAQ,SAAS,IAAA,6LAAS;IAC1B,MAAQ,CAAC,eAAe,iBAAiB,GAAG,IAAA,oNAAQ,EAAC;IACrD,MAAQ,CAAC,cAAc,gBAAgB,GAAG,IAAA,oNAAQ,EAAC;IACnD,MAAQ,sBAAsB,IAAA,kNAAM,EAAmB;IACvD,MAAQ,iBAAiB,IAAA,kNAAM,EAAkB,YAAY,WAAW;IAGxE,MAAM,eAAe;YAA+B;eAAzB,KAAK,MAAM,CAAC,QAAQ,OAAK,0BAAA,eAAe,OAAO,cAAtB,8CAAA,wBAAwB,QAAQ;;IAEpF,IAAA,qNAAS;iCAAC;YAEN,eAAe,OAAO,GAAG,YAAY,WAAW;QACpD;gCAAG;QAAC,YAAY,WAAW;KAAC;IAG5B,IAAA,qNAAS;iCAAC;YAEN,IAAI,CAAC,oBAAoB,OAAO,EAChC;gBACI,oBAAoB,OAAO,GAAG,IAAI,UAAU;gBAC5C,oBAAoB,OAAO,CAAC,MAAM;6CAAG;4BAKnB,YAEV;wBALJ,IAAI,QAAS;4BACT,MAAM;4BACN,QAAQ,KAAK,MAAM,CAAC,QAAQ;4BAC5B,QAAQ,GAAE,aAAA,KAAK,IAAI,cAAT,iCAAA,WAAW,QAAQ;wBACjC;wBACA,IAAI,EAAA,+BAAA,oBAAoB,OAAO,cAA3B,mDAAA,6BAA6B,UAAU,MAAK,UAAU,IAAI,EAC1D,oBAAoB,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;oBACxD;;gBACA,oBAAoB,OAAO,CAAC,SAAS;6CAAG,CAAC;wBAErC,MAAM,EAAC,IAAI,EAAE,OAAO,EAAC,GAAG,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ;wBACpD,QAAQ,GAAG,CAAC,kBAAkB;wBAC9B,iBAAiB;wBACjB,IAAI,mBAAmB,OACnB,gBAAgB;oBACxB;;gBACA,oBAAoB,OAAO,CAAC,OAAO;6CAAG,CAAC;wBACnC,QAAQ,KAAK,CAAC,oBAAoB;oBACtC;;YACJ;QACJ;gCAAE,EAAE;IAEL,qBACC,wOAAC;QAAI,SAAS;YAAO,YAAY,iBAAiB,CAAC,KAAK,MAAM;YAC1D,gBAAgB;YAChB,OAAO,IAAI,CAAC,AAAC,UAAwB,OAAf,KAAK,MAAM,CAAC,EAAE;QACxC;QAAG,WAAW,AAAC,yDAAwI,OAAhF,EAAA,2BAAA,YAAY,WAAW,cAAvB,+CAAA,yBAAyB,QAAQ,MAAK,KAAK,MAAM,CAAC,QAAQ,IAAI,gBAAe,KAAuD,OAApD,gBAAgB;;0BACnK,wOAAC;gBAAI,WAAU;0BACX,cAAA,wOAAC,sLAAK;oBAAC,WAAU;oBAAW,KAAK,+XAAW;oBAAE,KAAI;;;;;;;;;;;0BAEtD,wOAAC;gBAAI,WAAU;;kCACX,wOAAC;wBAAG,WAAU;kCAAe,KAAK,MAAM,CAAC,QAAQ;;;;;;kCACjD,wOAAC;wBAAE,WAAU;kCAAQ;;;;;;;;;;;;;;;;;;AAIjC;GA7DM;;QACoB,+LAAc;QACrB,iLAAO;QACL,6LAAS;;;KAHxB;uCA+DS","debugId":null}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/public/search.svg.mjs%20%28structured%20image%20object%20with%20data%20url%29"],"sourcesContent":["import src from \"IMAGE\";\nexport default { src, width: 24, height: 24, blurWidth: 0, blurHeight: 0};\n"],"names":[],"mappings":";;;;AAAA;;uCACe;IAAE,KAAA,+JAAG;IAAE,OAAO;IAAI,QAAQ;IAAI,WAAW;IAAG,YAAY;AAAC","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/SearchBar.tsx"],"sourcesContent":["import React from 'react'\nimport Image from 'next/image'\nimport search from \"../../../public/search.svg\"\nimport { useChatContext } from '@/context/ChatContextProvider';\n\nconst SearchBar = () => {\n  const chatContext = useChatContext();\n  return (\n    <div className='h-10 w-full px-4 bg-[#BEC7DA] rounded-full flex gap-2'>\n    <Image src={search} alt='search icon'/>\n    <input onChange={(event)=>chatContext.changeFilter(event.target.value)} className='outline-none w-full text-[20px]' type='text' placeholder=\"Search\"/>\n</div>\n)\n}\n\nexport default SearchBar\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;;AAEA,MAAM,YAAY;;IAChB,MAAM,cAAc,IAAA,+LAAc;IAClC,qBACE,wOAAC;QAAI,WAAU;;0BACf,wOAAC,sLAAK;gBAAC,KAAK,qXAAM;gBAAE,KAAI;;;;;;0BACxB,wOAAC;gBAAM,UAAU,CAAC,QAAQ,YAAY,YAAY,CAAC,MAAM,MAAM,CAAC,KAAK;gBAAG,WAAU;gBAAkC,MAAK;gBAAO,aAAY;;;;;;;;;;;;AAGhJ;GARM;;QACgB,+LAAc;;;KAD9B;uCAUS","debugId":null}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/AllChats.tsx"],"sourcesContent":["import React, { useEffect } from 'react'\nimport ChatPreview from './ChatPreview'\nimport SearchBar from './SearchBar';\nimport { useChatContext } from '@/context/ChatContextProvider';\nimport { useAuth } from '@/context/AuthProvider';\nimport { FriendshipProps } from '@/types/common.types';\n\nconst AllChats = () => \n{\n    const chatContext = useChatContext();\n    const auth = useAuth();\n    // useEffect(()=>\n    //     {\n    //         async function getFriends() {\n    //             const res = await fetch(`http://localhost:4000/friendships/${auth.user?.id}`);\n    //             const friends: FriendshipProps[] = await res.json();\n    //             if (friends.length > 0)\n    //             {\n    //                 chatContext.updateFriendList(friends);\n    //                 if (!chatContext.pointedUser)\n    //                 {\n    //                     chatContext.changePointedUser(friends[0]);\n    //                     console.log(chatContext.pointedUser);\n    //                 }\n    //             }\n    //         }\n    //         getFriends();\n    //     }, [chatContext.pointedUser])\n\n    const filteredData:FriendshipProps[] = chatContext.filter.length > 0 ? chatContext.friends.filter((data) => data.username.toLocaleLowerCase().includes(chatContext.filter.toLocaleLowerCase())) : chatContext.friends;\n    return (\n        <div className='flex-1 h-full rounded-t-[30] bg-linear-to-t to-[#93A1BF] from-[#4D658100] padding px-6 py-8 flex flex-col gap-y-5'>\n            <h1 className='text-[24px]'>ALL CHATS FOR</h1>\n            <SearchBar />\n            <div className='flex flex-col gap-y-5 h-full overflow-y-scroll'>\n                {\n                    filteredData.map((v:FriendshipProps) =>\n                        {\n                            return (<ChatPreview key={v.id} friend={v}/>)\n                        }\n                    )\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default AllChats\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;;AAGA,MAAM,WAAW;;IAEb,MAAM,cAAc,IAAA,+LAAc;IAClC,MAAM,OAAO,IAAA,iLAAO;IACpB,iBAAiB;IACjB,QAAQ;IACR,wCAAwC;IACxC,6FAA6F;IAC7F,mEAAmE;IACnE,sCAAsC;IACtC,gBAAgB;IAChB,yDAAyD;IACzD,gDAAgD;IAChD,oBAAoB;IACpB,iEAAiE;IACjE,4DAA4D;IAC5D,oBAAoB;IACpB,gBAAgB;IAChB,YAAY;IACZ,wBAAwB;IACxB,oCAAoC;IAEpC,MAAM,eAAiC,YAAY,MAAM,CAAC,MAAM,GAAG,IAAI,YAAY,OAAO,CAAC,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,CAAC,iBAAiB,GAAG,QAAQ,CAAC,YAAY,MAAM,CAAC,iBAAiB,OAAO,YAAY,OAAO;IACrN,qBACI,wOAAC;QAAI,WAAU;;0BACX,wOAAC;gBAAG,WAAU;0BAAc;;;;;;0BAC5B,wOAAC,qMAAS;;;;;0BACV,wOAAC;gBAAI,WAAU;0BAEP,aAAa,GAAG,CAAC,CAAC;oBAEV,qBAAQ,wOAAC,uMAAW;wBAAY,QAAQ;uBAAd,EAAE,EAAE;;;;;gBAClC;;;;;;;;;;;;AAMxB;GAtCM;;QAEkB,+LAAc;QACrB,iLAAO;;;KAHlB;uCAwCS","debugId":null}},
    {"offset": {"line": 325, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/components/features/chat/ChatsWrapper.tsx"],"sourcesContent":["\"use client\"\nimport React, { useRef, useEffect } from 'react'\nimport AllChats from './AllChats'\nimport MainChat from './MainChat'\nimport { MessageProps } from '@/types/common.types'\nimport { useAuth } from '../../../context/AuthProvider'\nimport { useChatContext } from '@/context/ChatContextProvider'\nimport {FriendshipProps} from \"@/types/common.types\"\n\nconst ChatsWrapper = () => {\n  const auth = useAuth();\n  // const chatContext = useChatContext();\n  // const socket = useRef<WebSocket | null>(null) ;\n  // const currentPointed = useRef<FriendshipProps>(chatContext.pointedUser);\n  \n  // useEffect(() =>\n  // {\n  //     currentPointed.current = chatContext.pointedUser;\n  // }, [chatContext.pointedUser])\n\n\n\n  // useEffect(()=>\n  // {\n  //   if (!socket.current)\n  //   {\n  //     socket.current = new WebSocket(\"ws://localhost:4000/sockets/messages\");\n  //     socket.current.onopen = () =>\n  //     {\n  //       let data = {\n  //         type: \"auth\",\n  //         content: auth.user?.username \n  //       }\n  //       if (socket.current?.readyState === WebSocket.OPEN)\n  //         socket.current.send(JSON.stringify(data));\n  //     }\n  //     socket.current.onmessage = (msg)=>\n  //     {\n  //       const {receiver, sender, content, id} = JSON.parse(msg.data);\n  //       const newMessage: MessageProps = {sender: sender, receiver: receiver, content: content, id: id}\n  //       console.log(\"adding new message\", newMessage);\n  //       if (newMessage.receiver === currentPointed.current.username || newMessage.sender === currentPointed.current.username)\n  //         chatContext.updateMessages((previous) => [newMessage, ...previous]);\n  //     }\n  //     socket.current.onerror = (error) => {\n  //       console.error('WebSocket error:', error);\n  //     };\n  //   }\n  // },[])\n\n  return (   \n    auth.isLogged && auth.user && <>\n        <div className='h-dvh flex gap-3'>\n          <AllChats />\n          {/* <MainChat ref={socket}/> */}\n        </div>\n    </>\n  )\n}\n\nexport default ChatsWrapper\n"],"names":[],"mappings":";;;;;AAEA;AAGA;;;AALA;;;AASA,MAAM,eAAe;;IACnB,MAAM,OAAO,IAAA,iLAAO;IACpB,wCAAwC;IACxC,kDAAkD;IAClD,2EAA2E;IAE3E,kBAAkB;IAClB,IAAI;IACJ,wDAAwD;IACxD,gCAAgC;IAIhC,iBAAiB;IACjB,IAAI;IACJ,yBAAyB;IACzB,MAAM;IACN,8EAA8E;IAC9E,oCAAoC;IACpC,QAAQ;IACR,qBAAqB;IACrB,wBAAwB;IACxB,wCAAwC;IACxC,UAAU;IACV,2DAA2D;IAC3D,qDAAqD;IACrD,QAAQ;IACR,yCAAyC;IACzC,QAAQ;IACR,sEAAsE;IACtE,wGAAwG;IACxG,uDAAuD;IACvD,8HAA8H;IAC9H,+EAA+E;IAC/E,QAAQ;IACR,4CAA4C;IAC5C,kDAAkD;IAClD,SAAS;IACT,MAAM;IACN,QAAQ;IAER,OACE,KAAK,QAAQ,IAAI,KAAK,IAAI,kBAAI;kBAC1B,cAAA,wOAAC;YAAI,WAAU;sBACb,cAAA,wOAAC,oMAAQ;;;;;;;;;;;AAKnB;GAjDM;;QACS,iLAAO;;;KADhB;uCAmDS","debugId":null}},
    {"offset": {"line": 405, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/app/chats/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\nimport ChatsWrapper from \"@/components/features/chat/ChatsWrapper\";\nimport { useChatContext } from \"@/context/ChatContextProvider\";\n\n\nconst chat = ({params}: {params: {id: number}}) =>\n{\n    const {id} = params;\n    return (\n\t\t\t<ChatsWrapper  />\n    )\n};\n\nexport default chat;"],"names":[],"mappings":";;;;;AACA;AADA;;;AAKA,MAAM,OAAO;QAAC,EAAC,MAAM,EAAyB;IAE1C,MAAM,EAAC,EAAE,EAAC,GAAG;IACb,qBACD,wOAAC,wMAAY;;;;;AAEhB;uCAEe","debugId":null}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///home/shamdoun/Desktop/ft_transcendence/frontend/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}